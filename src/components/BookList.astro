---
import { Book } from '../types'
import AddToCart from './AddToCart';

function formatCurrency(amount:number) {
    return new Intl.NumberFormat('en-us',{
        style: 'currency',
        currency: 'USD',
        // minimumFractionDigits: 2
    }).format(amount);
}

const result = await fetch('http://localhost:3001/books');

if(!result.ok){
    console.log(result);
} 

const bookList: Book[] = await result.json();
---

<section class="buy-books">
    {
        bookList.map((book: Book) => (
                <div class="book">
                    <img src={book.image.src} alt={book.image.alt} />
                    <h1>{book.title}</h1>
                    <p>{book.description}</p>
                    <p>{formatCurrency(book.price)}</p>
                    {/*This whole section would be static, except the AddToCart functionality */}
                    <AddToCart item={book} client:only="react" />
                </div>
            )
        )
    }
</section>

<style>


.buy-books {
    display: flex;
    gap:1rem;
    flex-wrap: wrap;
    justify-content: center;
    margin: 1rem 0;
}

.book{
    flex: 1 1 24%;
    width: 250px;
}

.book img{
    aspect-ratio: 1;
    border-radius: 1.125rem;
    display: block;
    width: 100%;
}

.book h2{
    font-size: 1.125rem;
    margin: 0.75rem 0 0;
}

.book p{
    margin: 0.25rem 0 0;
}

</style>
